services:
  metavoice-teacher:
    build:
      context: .
      dockerfile: Dockerfile.metavoice.inference
    image: metavoice-5080
    environment:
      - CUDA_VISIBLE_DEVICES=all
      # HF repo can be overridden here if you fine-tuned:
      - HUGGINGFACE_REPO_ID=metavoiceio/metavoice-1B-v0.1
    # GPU passthrough configuration using CDI (same as your original)
    devices:
      - "nvidia.com/gpu=all"
    ports:
      - "58003:58003"
    volumes:
      # optional: share HF cache
      - ~/.cache/huggingface:/root/.cache/huggingface:rw
      # reference clips from host
      - ./speakers:/speakers:ro
